<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
    <title>Our Love Story-Download by http://www.codefans.net</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <style type="text/css">
        @font-face {
            font-family: digit;
            src: url('digital-7_mono.ttf') format("truetype");
        }
    </style>
    <link href="style/default.css" type="text/css" rel="stylesheet">
    <script type="text/javascript" src="style/jquery.js"></script>
    <script type="text/javascript" src="style/garden.js"></script>
    <script type="text/javascript" src="style/functions.js"></script>
</head>

<body>
    <div id="mainDiv">
        <div id="content">
            <div id="code">
                <span class="comments">/**</span><br />
                <span class="space" /><span class="comments">* We are both XXX Unversity  business administration and programmers,</span><br />
                <span class="space" /><span class="comments">* so I write some code to show my love to you.</span><br />
                <span class="space" /><span class="comments">*/</span><br /> Boy i = <span class="keyword">new</span> Boy(<span class="string">"boyname"</span>);<br /> Girl u = <span class="keyword">new</span> Girl(<span class="string">"girlname"</span>);<br
                />
                <span class="comments">// April 28, 2012, I told you I love you. </span><br /> i.love(u);
                <br />
                <span class="comments">// but..., what you said that meaning we are still good friends.</span><br /> u.sayOtherthing();
                <br />
                <span class="comments">// Since then, I ask you for the reason.</span><br />
                <span class="keyword">var</span> reason=i.ask(u);<br />
                <span class="comments">// you say we were not understand enough for each other .</span><br /> $("body").append(reason);
                <br />
                <span class="comments">// You say that it is too quickily to turn our relation of lover.</span><br />
                <span class="comments">// And take care of u and our love.</span><br /> i.takeCareOf(u);
                <br />
                <span class="comments">// So I keep waiting and I have confidence that you will.</span><br />
                <span class="keyword">boolean</span> isAccept = <span class="keyword">false</span>;<br />
                <span class="keyword">while</span> (isAccept) {<br />
                <span class="placeholder" />i.waitFor(u);<br />
                <span class="placeholder" /><span class="comments">// I think it is an important decision</span><br />
                <span class="placeholder" /><span class="comments">// and you should forgot the unhappy things that happended before.</span><br />
                <span class="placeholder" />isAccept = u.thinkOver();<br /> }
                <br />
                <span class="comments">// After a please sound of accept, we will live happily ever after.</span><br /> u.accept(i);
                <br /> i.liveHappilyWith(u);
                <br />
                <script type="text/javascript">
                    <!--
                    google_ad_client = "ca-pub-3712320065678109";
                    /* lovead */
                    google_ad_slot = "0650322805";
                    google_ad_width = 320;
                    google_ad_height = 50;
                    //-->
                </script>
                <script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
                </script>
            </div>
            <div id="loveHeart">
                <canvas id="garden"></canvas>
                <div id="words">
                    <div id="messages">
                        <center>
                            <script type="text/javascript">
                                <!--
                                google_ad_client = "ca-pub-3712320065678109";
                                /* lovead */
                                google_ad_slot = "0650322805";
                                google_ad_width = 320;
                                google_ad_height = 50;
                                //-->
                            </script>
                            <script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
                            </script>
                        </center>
                        would you marry me?
                        <div id="elapseClock" style="display:none"></div>
                        <a href='#' id="accept">点这里接受！</a>
                    </div>
                    <div id="loveu">
                        Love u forever and ever.<br/>
                        <div class="signature">- boyname</div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <script type="text/javascript">
        var r = 20;
        var radian; //弧度  
        var i;
        var radianDecrement; //弧度增量  
        var time = 1000; //每个点之间的时间间隔  
        var intervalId;
        var num = 90; //分割为 360 个点  
        var startRadian = Math.PI;
        var ctx;

        var offsetX = $("#loveHeart").width() / 2;
        var offsetY = $("#loveHeart").height() / 2 - 55;

        if (!document.createElement('canvas').getContext) {
            var msg = document.createElement("div");
            msg.id = "errorMsg";
            msg.innerHTML = "Your browser doesn't support HTML5!<br/>Recommend use Chrome 14+/IE 9+/Firefox 7+/Safari 4+";
            document.body.appendChild(msg);
            $("#code").css("display", "none")
            $("#copyright").css("position", "absolute");
            $("#copyright").css("bottom", "10px");
            document.execCommand("stop");
        } else {

            setTimeout(function() {
                adjustWordsPosition();
                startAnimation();
            }, 0);

            $("#accept").click(function() {
                $(this).hide();
                $("#elapseClock").show();
                var together = new Date();
                timeElapse(together);
                setInterval(function() {
                    timeElapse(together);
                }, 5000);
            })
            adjustCodePosition();
            $("#code").typewriter();
        }

        function startAnimation() {
            ctx = document.getElementById("garden").getContext("2d");
            //让画布撑满整个屏幕，-20是滚动条的位置，需留出。如滚动条出现则会挤压画布。  
            ctx.width = $("#loveHeart").width();
            ctx.heigh = $("#loveHeart").height();
            drawHeart();
        }

        function drawHeart() {

            ctx.strokeStyle = "red";
            ctx.lineWidth = 0.1; //设置线的宽度  
            radian = startRadian; //弧度设为初始弧度  
            radianDecrement = Math.PI / num * 2;
            ctx.moveTo(getX(radian), getY(radian)); //移动到初始点  
            i = 0;
            intervalId = setInterval("printHeart()", time);
        }
        //x = 16 sin^3 t, y = (13 cos t - 5 cos 2t - 2 cos 3t - cos 4t)  
        function printHeart() {
            radian += radianDecrement;

            //ctx.lineTo(getX(radian), getY(radian)); //在旧点和新点之间连线
            var xpoint = getX(radian);
            var ypoint = getY(radian);
            var r = 5

            //ctx.moveTo(xpoint + r, ypoint)
            //ctx.arc(xpoint, ypoint, r, 0, 2 * Math.PI, false)

            drawstar(xpoint, ypoint)
            i++;

            //ctx.stroke(); //画线 

            if (i >= num) {
                //if (i > 4)
                clearInterval(intervalId);
                //document.getElementById("bs").innerHTML = arr.join("");//打印所有的XY坐标点。  
            }
        }

        function getX(t) { //由弧度得到 X 坐标  
            return $("#garden").width() / 2 + r * (16 * Math.pow(Math.sin(t), 3));
        }

        function getY(t) { //由弧度得到 Y 坐标  
            return $("#garden").height() / 2 - 55 - r * (13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t));
        }

        function drawstar(x, y) {
            var R = 10
            var r = 4
            ctx.beginPath();
            //设置是个顶点的坐标，根据顶点制定路径   
            for (var i = 0; i < 5; i++) {
                ctx.lineTo(Math.cos((18 + i * 72) / 180 * Math.PI) * R + x, -Math.sin((18 + i * 72) / 180 * Math.PI) * R + y);
                ctx.lineTo(Math.cos((54 + i * 72) / 180 * Math.PI) * r + x, -Math.sin((54 + i * 72) / 180 * Math.PI) * r + y);
            }
            ctx.closePath();
            //设置边框样式以及填充颜色   
            ctx.lineWidth = "1";
            ctx.fillStyle = "#F6F152";
            ctx.strokeStyle = "#F5270B";
            ctx.fill();
            ctx.stroke();
        }
    </script>
</body>

</html>
